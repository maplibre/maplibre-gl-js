<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2104px" preserveAspectRatio="none" style="width:1258px;height:2104px;" version="1.1" viewBox="0 0 1258 2104" width="1258px" zoomAndPan="magnify"><defs><filter height="300%" id="f1515qbmadyqe1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="2089.8496" style="stroke: #A80036; stroke-width: 1.0;" width="632" x="598.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47" x="891" y="16.5684">worker</text><rect fill="#FFFFFF" filter="url(#f1515qbmadyqe1)" height="1526.7266" style="stroke: #000000; stroke-width: 2.0;" width="972.5" x="274" y="207.3516"/><rect fill="#FFFFFF" height="44.2656" style="stroke: none; stroke-width: 1.0;" width="972.5" x="274" y="253.9727"/><rect fill="#FFFFFF" height="145.1973" style="stroke: none; stroke-width: 1.0;" width="972.5" x="274" y="298.2383"/><rect fill="#FFFFFF" height="1290.6426" style="stroke: none; stroke-width: 1.0;" width="972.5" x="274" y="443.4355"/><rect fill="#FFFFFF" filter="url(#f1515qbmadyqe1)" height="260.1289" style="stroke: #000000; stroke-width: 2.0;" width="548.5" x="688" y="524.0117"/><rect fill="#FFFFFF" height="128.8867" style="stroke: none; stroke-width: 1.0;" width="548.5" x="688" y="655.2539"/><rect fill="#FFFFFF" filter="url(#f1515qbmadyqe1)" height="797.3848" style="stroke: #000000; stroke-width: 2.0;" width="763" x="417.5" y="827.4512"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="32" x2="32" y1="58.7988" y2="2038.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="169" x2="169" y1="58.7988" y2="2038.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="316" x2="316" y1="58.7988" y2="2038.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="450.5" x2="450.5" y1="58.7988" y2="2038.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="539.5" x2="539.5" y1="58.7988" y2="2038.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="635.5" x2="635.5" y1="58.7988" y2="2038.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="757" x2="757" y1="58.7988" y2="2038.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="879.5" x2="879.5" y1="58.7988" y2="2038.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1041.5" x2="1041.5" y1="58.7988" y2="2038.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1175.5" x2="1175.5" y1="58.7988" y2="2038.873"/><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="8" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="15" y="43.8457">map</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="8" y="2037.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="15" y="2058.4082">map</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="114" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="121" y="43.8457">source_cache</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="114" y="2037.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="121" y="2058.4082">source_cache</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="284" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="291" y="43.8457">source</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="284" y="2037.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="291" y="2058.4082">source</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="43" x="427.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="434.5" y="43.8457">ajax</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="43" x="427.5" y="2037.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="434.5" y="2058.4082">ajax</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="487.5" y="6.8223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="494.5" y="27.3574">glyph/image</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="507.5" y="43.8457">manager</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="487.5" y="2037.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="494.5" y="2058.4082">glyph/image</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="507.5" y="2074.8965">manager</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="602.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="609.5" y="43.8457">worker</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="602.5" y="2037.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="609.5" y="2058.4082">worker</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="698" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="705" y="43.8457">worker_source</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="698" y="2037.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="705" y="2058.4082">worker_source</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="832.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="839.5" y="43.8457">worker_tile</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="832.5" y="2037.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="839.5" y="2058.4082">worker_tile</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="1009.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="1016.5" y="43.8457">bucket</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="1009.5" y="2037.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="1016.5" y="2058.4082">bucket</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="1124.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="1131.5" y="43.8457">worker_ajax</text><rect fill="#FEFECE" filter="url(#f1515qbmadyqe1)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="1124.5" y="2037.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="1131.5" y="2058.4082">worker_ajax</text><polygon fill="#A80036" points="157,86.1094,167,90.1094,157,94.1094,161,90.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="163" y1="90.1094" y2="90.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="39" y="85.3672">update(transform)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="169" x2="211" y1="134.7305" y2="134.7305"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211" x2="211" y1="134.7305" y2="147.7305"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="170" x2="211" y1="147.7305" y2="147.7305"/><polygon fill="#A80036" points="180,143.7305,170,147.7305,180,151.7305,176,147.7305" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="176" y="114.6777">compute covering</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="176" y="129.9883">tiles</text><polygon fill="#A80036" points="304,188.3516,314,192.3516,304,196.3516,308,192.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="169" x2="310" y1="192.3516" y2="192.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="176" y="172.2988">loadTile() for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="176" y="187.6094">each missing tile</text><path d="M274,207.3516 L336,207.3516 L336,214.3516 L326,224.3516 L274,224.3516 L274,207.3516 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1526.7266" style="stroke: #000000; stroke-width: 2.0;" width="972.5" x="274" y="207.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="289" y="220.9199">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="351" y="219.9863">[raster_tile_source]</text><polygon fill="#A80036" points="439,241.9727,449,245.9727,439,249.9727,443,245.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="445" y1="245.9727" y2="245.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="323" y="241.2305">getImage</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="274" x2="1246.5" y1="254.9727" y2="254.9727"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="279" y="265.6074">[image_source]</text><polygon fill="#A80036" points="439,286.2383,449,290.2383,439,294.2383,443,290.2383" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="445" y1="290.2383" y2="290.2383"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="323" y="285.4961">getImage (once)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="274" x2="1246.5" y1="299.2383" y2="299.2383"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="279" y="309.873">[raster_dem_tile_source]</text><polygon fill="#A80036" points="439,330.5039,449,334.5039,439,338.5039,443,334.5039" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="445" y1="334.5039" y2="334.5039"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="323" y="329.7617">getImage()</text><polygon fill="#A80036" points="623.5,359.8145,633.5,363.8145,623.5,367.8145,627.5,363.8145" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="629.5" y1="363.8145" y2="363.8145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="323" y="359.0723">loadDEMTile()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="635.5" x2="677.5" y1="393.125" y2="393.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="677.5" x2="677.5" y1="393.125" y2="406.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="636.5" x2="677.5" y1="406.125" y2="406.125"/><polygon fill="#A80036" points="646.5,402.125,636.5,406.125,646.5,410.125,642.5,406.125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="642.5" y="388.3828">add 1px buffer</text><polygon fill="#A80036" points="327,431.4355,317,435.4355,327,439.4355,323,435.4355" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="321" x2="634.5" y1="435.4355" y2="435.4355"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="333" y="430.6934">DEMData</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="274" x2="1246.5" y1="444.4355" y2="444.4355"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="203" x="279" y="455.0703">[vector_tile_source/geojson_source]</text><polygon fill="#A80036" points="623.5,475.7012,633.5,479.7012,623.5,483.7012,627.5,479.7012" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="629.5" y1="479.7012" y2="479.7012"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="323" y="474.959">loadTile()</text><polygon fill="#A80036" points="745.5,505.0117,755.5,509.0117,745.5,513.0117,749.5,509.0117" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="635.5" x2="751.5" y1="509.0117" y2="509.0117"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="642.5" y="504.2695">loadVectorTile()</text><path d="M688,524.0117 L750,524.0117 L750,531.0117 L740,541.0117 L688,541.0117 L688,524.0117 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="260.1289" style="stroke: #000000; stroke-width: 2.0;" width="548.5" x="688" y="524.0117"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="703" y="537.5801">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="765" y="536.6465">[vector_tile_source]</text><polygon fill="#A80036" points="1163.5,558.6328,1173.5,562.6328,1163.5,566.6328,1167.5,562.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="757.5" x2="1169.5" y1="562.6328" y2="562.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="764.5" y="557.8906">getArrayBuffer()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="757.5" x2="799.5" y1="591.9434" y2="591.9434"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="799.5" y1="591.9434" y2="604.9434"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="758.5" x2="799.5" y1="604.9434" y2="604.9434"/><polygon fill="#A80036" points="768.5,600.9434,758.5,604.9434,768.5,608.9434,764.5,604.9434" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="764.5" y="587.2012">decode pbf</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="757.5" x2="799.5" y1="634.2539" y2="634.2539"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="799.5" y1="634.2539" y2="647.2539"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="758.5" x2="799.5" y1="647.2539" y2="647.2539"/><polygon fill="#A80036" points="768.5,643.2539,758.5,647.2539,768.5,651.2539,764.5,647.2539" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="764.5" y="629.5117">parse vector tile</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="688" x2="1236.5" y1="656.2539" y2="656.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="693" y="666.8887">[geojson_source]</text><polygon fill="#A80036" points="1163.5,687.5195,1173.5,691.5195,1163.5,695.5195,1167.5,691.5195" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="757.5" x2="1169.5" y1="691.5195" y2="691.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="764.5" y="686.7773">getJSON()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="757.5" x2="799.5" y1="720.8301" y2="720.8301"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="799.5" y1="720.8301" y2="733.8301"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="758.5" x2="799.5" y1="733.8301" y2="733.8301"/><polygon fill="#A80036" points="768.5,729.8301,758.5,733.8301,768.5,737.8301,764.5,733.8301" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="764.5" y="716.0879">geojson-vt parse</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="757.5" x2="799.5" y1="763.1406" y2="763.1406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="799.5" y1="763.1406" y2="776.1406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="758.5" x2="799.5" y1="776.1406" y2="776.1406"/><polygon fill="#A80036" points="768.5,772.1406,758.5,776.1406,768.5,780.1406,764.5,776.1406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="764.5" y="758.3984">getTile()</text><polygon fill="#A80036" points="867.5,808.4512,877.5,812.4512,867.5,816.4512,871.5,812.4512" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="757.5" x2="873.5" y1="812.4512" y2="812.4512"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="764.5" y="807.709">parse()</text><path d="M417.5,827.4512 L491.5,827.4512 L491.5,834.4512 L481.5,844.4512 L417.5,844.4512 L417.5,827.4512 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="797.3848" style="stroke: #000000; stroke-width: 2.0;" width="763" x="417.5" y="827.4512"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="432.5" y="841.0195">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="506.5" y="840.0859">[for each "layer family"]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="879.5" x2="921.5" y1="881.3828" y2="881.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="921.5" y1="881.3828" y2="894.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="880.5" x2="921.5" y1="894.3828" y2="894.3828"/><polygon fill="#A80036" points="890.5,890.3828,880.5,894.3828,890.5,898.3828,886.5,894.3828" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="886.5" y="861.3301">calculate layout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="886.5" y="876.6406">properties</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="879.5" x2="921.5" y1="923.6934" y2="923.6934"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="921.5" y1="923.6934" y2="936.6934"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="880.5" x2="921.5" y1="936.6934" y2="936.6934"/><polygon fill="#A80036" points="890.5,932.6934,880.5,936.6934,890.5,940.6934,886.5,936.6934" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="886.5" y="918.9512">createBucket</text><polygon fill="#A80036" points="1029.5,962.0039,1039.5,966.0039,1029.5,970.0039,1033.5,966.0039" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="879.5" x2="1035.5" y1="966.0039" y2="966.0039"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="886.5" y="961.2617">populate()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1041.5" x2="1083.5" y1="1041.2461" y2="1041.2461"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1083.5" x2="1083.5" y1="1041.2461" y2="1054.2461"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1042.5" x2="1083.5" y1="1054.2461" y2="1054.2461"/><polygon fill="#A80036" points="1052.5,1050.2461,1042.5,1054.2461,1052.5,1058.2461,1048.5,1054.2461" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="1048.5" y="990.5723">compute triangles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="1048.5" y="1005.8828">needed by GPU</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1048.5" y="1021.1934">for each feature we</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="1048.5" y="1036.5039">have data for</text><polygon fill="#A80036" points="551,1079.5566,541,1083.5566,551,1087.5566,547,1083.5566" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="545" x2="878.5" y1="1083.5566" y2="1083.5566"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="557" y="1078.8145">getGlyphs</text><polygon fill="#A80036" points="462,1124.1777,452,1128.1777,462,1132.1777,458,1128.1777" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="456" x2="539" y1="1128.1777" y2="1128.1777"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="468" y="1108.125">Fetch font</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="468" y="1123.4355">PBFs</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="540" x2="582" y1="1157.4883" y2="1157.4883"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="582" x2="582" y1="1157.4883" y2="1170.4883"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="541" x2="582" y1="1170.4883" y2="1170.4883"/><polygon fill="#A80036" points="551,1166.4883,541,1170.4883,551,1174.4883,547,1170.4883" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="547" y="1152.7461">TinySDF</text><polygon fill="#A80036" points="551,1195.7988,541,1199.7988,551,1203.7988,547,1199.7988" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="545" x2="878.5" y1="1199.7988" y2="1199.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="557" y="1195.0566">getImages</text><polygon fill="#A80036" points="462,1240.4199,452,1244.4199,462,1248.4199,458,1244.4199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="456" x2="539" y1="1244.4199" y2="1244.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="468" y="1224.3672">Fetch icon</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="468" y="1239.6777">images</text><polygon fill="#A80036" points="867.5,1269.7305,877.5,1273.7305,867.5,1277.7305,871.5,1273.7305" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="540" x2="873.5" y1="1273.7305" y2="1273.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="547" y="1268.9883">glyph/Image dependencies</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="879.5" x2="921.5" y1="1303.041" y2="1303.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="921.5" y1="1303.041" y2="1316.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="880.5" x2="921.5" y1="1316.041" y2="1316.041"/><polygon fill="#A80036" points="890.5,1312.041,880.5,1316.041,890.5,1320.041,886.5,1316.041" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="886.5" y="1298.2988">maybePrepare()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="879.5" x2="921.5" y1="1345.3516" y2="1345.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="921.5" y1="1345.3516" y2="1358.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="880.5" x2="921.5" y1="1358.3516" y2="1358.3516"/><polygon fill="#A80036" points="890.5,1354.3516,880.5,1358.3516,890.5,1362.3516,886.5,1358.3516" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="886.5" y="1340.6094">create GlyphAtlas</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="879.5" x2="921.5" y1="1387.6621" y2="1387.6621"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="921.5" y1="1387.6621" y2="1400.6621"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="880.5" x2="921.5" y1="1400.6621" y2="1400.6621"/><polygon fill="#A80036" points="890.5,1396.6621,880.5,1400.6621,890.5,1404.6621,886.5,1400.6621" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="886.5" y="1382.9199">create ImageAtlas</text><polygon fill="#A80036" points="1029.5,1425.9727,1039.5,1429.9727,1029.5,1433.9727,1033.5,1429.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="879.5" x2="1035.5" y1="1429.9727" y2="1429.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="886.5" y="1425.2305">addFeatures</text><polygon fill="#A80036" points="1029.5,1455.2832,1039.5,1459.2832,1029.5,1463.2832,1033.5,1459.2832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="879.5" x2="1035.5" y1="1459.2832" y2="1459.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="886.5" y="1454.541">performSymbolLayout</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1041.5" x2="1083.5" y1="1488.5938" y2="1488.5938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1083.5" x2="1083.5" y1="1488.5938" y2="1501.5938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1042.5" x2="1083.5" y1="1501.5938" y2="1501.5938"/><polygon fill="#A80036" points="1052.5,1497.5938,1042.5,1501.5938,1052.5,1505.5938,1048.5,1501.5938" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="1048.5" y="1483.8516">place characters</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1041.5" x2="1083.5" y1="1546.2148" y2="1546.2148"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1083.5" x2="1083.5" y1="1546.2148" y2="1559.2148"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1042.5" x2="1083.5" y1="1559.2148" y2="1559.2148"/><polygon fill="#A80036" points="1052.5,1555.2148,1042.5,1559.2148,1052.5,1563.2148,1048.5,1559.2148" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="1048.5" y="1526.1621">compute collision</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="38" x="1048.5" y="1541.4727">boxes</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1041.5" x2="1083.5" y1="1603.8359" y2="1603.8359"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1083.5" x2="1083.5" y1="1603.8359" y2="1616.8359"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1042.5" x2="1083.5" y1="1616.8359" y2="1616.8359"/><polygon fill="#A80036" points="1052.5,1612.8359,1042.5,1616.8359,1052.5,1620.8359,1048.5,1616.8359" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="1048.5" y="1583.7832">compute triangles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="1048.5" y="1599.0938">needed by GPU</text><polygon fill="#A80036" points="327,1649.1465,317,1653.1465,327,1657.1465,323,1653.1465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="321" x2="878.5" y1="1653.1465" y2="1653.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="333" y="1648.4043">callback(bucket, featureIndex, collision boxes, GlyphAtlas, ImageAtlas)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="358" y1="1713.0781" y2="1713.0781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="358" x2="358" y1="1713.0781" y2="1726.0781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="317" x2="358" y1="1726.0781" y2="1726.0781"/><polygon fill="#A80036" points="327,1722.0781,317,1726.0781,327,1730.0781,323,1726.0781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="323" y="1677.7148">loadVectorData()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="323" y="1693.0254">decode</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="323" y="1708.3359">response</text><polygon fill="#A80036" points="180,1758.3887,170,1762.3887,180,1766.3887,176,1762.3887" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="174" x2="315" y1="1762.3887" y2="1762.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="186" y="1757.6465">Tile</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="169" x2="211" y1="1822.3203" y2="1822.3203"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="211" x2="211" y1="1822.3203" y2="1835.3203"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="170" x2="211" y1="1835.3203" y2="1835.3203"/><polygon fill="#A80036" points="180,1831.3203,170,1835.3203,180,1839.3203,176,1835.3203" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="176" y="1786.957">_backfillDEM()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="176" y="1802.2676">copy 1px buffer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="176" y="1817.5781">from neigboring tiles</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="358" y1="1895.252" y2="1895.252"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="358" x2="358" y1="1895.252" y2="1908.252"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="317" x2="358" y1="1908.252" y2="1908.252"/><polygon fill="#A80036" points="327,1904.252,317,1908.252,327,1912.252,323,1908.252" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="323" y="1859.8887">fire('data', {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="331" y="1875.1992">dataType: 'source'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="323" y="1890.5098">})</text><polygon fill="#A80036" points="180,1918.252,170,1922.252,180,1926.252,176,1922.252" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="174" x2="315" y1="1922.252" y2="1922.252"/><polygon fill="#A80036" points="43,1932.252,33,1936.252,43,1940.252,39,1936.252" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="37" x2="168" y1="1936.252" y2="1936.252"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="74" y1="1965.5625" y2="1965.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="74" y1="1965.5625" y2="1978.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="33" x2="74" y1="1978.5625" y2="1978.5625"/><polygon fill="#A80036" points="43,1974.5625,33,1978.5625,43,1982.5625,39,1978.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="39" y="1960.8203">fire('sourcedata')</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="74" y1="2007.873" y2="2007.873"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="74" y1="2007.873" y2="2020.873"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="33" x2="74" y1="2020.873" y2="2020.873"/><polygon fill="#A80036" points="43,2016.873,33,2020.873,43,2024.873,39,2020.873" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="39" y="2003.1309">render new frame</text><!--
@startuml
participant map
participant source_cache
participant source
participant ajax
participant "glyph/image\nmanager"
box worker
participant worker
participant worker_source
participant worker_tile
participant bucket
participant worker_ajax
end box

map->source_cache: update(transform)
source_cache->source_cache: compute covering\ntiles
source_cache->source: loadTile() for\neach missing tile
alt raster_tile_source
source->ajax: getImage
else image_source
source->ajax: getImage (once)
else raster_dem_tile_source
source->ajax: getImage()
source->worker: loadDEMTile()
worker->worker: add 1px buffer
worker- ->source: DEMData
else vector_tile_source/geojson_source
source->worker: loadTile()
worker->worker_source: loadVectorTile()
alt vector_tile_source
worker_source->worker_ajax: getArrayBuffer()
worker_source->worker_source: decode pbf
worker_source->worker_source: parse vector tile
else geojson_source
worker_source->worker_ajax: getJSON()
worker_source->worker_source: geojson-vt parse
worker_source->worker_source: getTile()
end
worker_source->worker_tile: parse()
loop for each "layer family"
worker_tile->worker_tile: calculate layout\nproperties
worker_tile->worker_tile: createBucket
worker_tile->bucket: populate()
bucket->bucket: compute triangles\nneeded by GPU\nfor each feature we\nhave data for
worker_tile->"glyph/image\nmanager": getGlyphs
"glyph/image\nmanager"->ajax: Fetch font\nPBFs
"glyph/image\nmanager"->"glyph/image\nmanager": TinySDF
worker_tile->"glyph/image\nmanager": getImages
"glyph/image\nmanager"->ajax: Fetch icon\nimages
"glyph/image\nmanager"- ->worker_tile: glyph/Image dependencies
worker_tile->worker_tile: maybePrepare()
worker_tile->worker_tile: create GlyphAtlas
worker_tile->worker_tile: create ImageAtlas
worker_tile->bucket: addFeatures
worker_tile->bucket: performSymbolLayout
bucket->bucket: place characters
bucket->bucket: compute collision\nboxes
bucket->bucket: compute triangles\nneeded by GPU
end
worker_tile- ->source: callback(bucket, featureIndex, collision boxes, GlyphAtlas, ImageAtlas)
source->source: loadVectorData()\ndecode\nresponse
end
source- ->source_cache: Tile
source_cache- ->source_cache: _backfillDEM()\ncopy 1px buffer\nfrom neigboring tiles
source->source: fire('data', {\n  dataType: 'source'\n})
source->source_cache:
source_cache->map:
map->map: fire('sourcedata')
map->map: render new frame
@enduml

PlantUML version 1.2019.06(Fri May 24 13:10:25 EDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_162-b12
Operating System: Mac OS X
OS Version: 10.15.7
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>