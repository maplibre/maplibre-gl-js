<!DOCTYPE html>
<html lang="en">
<head>
    <title>MapLibre GL JS debug page</title>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='stylesheet' href='../../dist/maplibre-gl.css' />
    <style>
        body { margin: 0; padding: 0; }
        html, body, #map { height: 100%; }
    </style>
</head>

<body>
<div id='map'></div>

<script src='../../dist/maplibre-gl-dev.js'></script>
<script src='./light-demotiles.js'></script>
<script>
var style = window.lightdemotiles;

var map = window.map = new maplibregl.Map({
    container: 'map',
    zoom: 5,
    center: [0.02, 52],
    style,
    hash: style
});

var sourceData = {
    'type': 'FeatureCollection',
    'features': [{
        'type': 'Feature',
        'properties': {
            'name': 'sprite2/airport',
            'featureclass': 'top'
        },
        'geometry': {
            'type': 'Point',
            'coordinates': [0, 52]
        },
        'id': 163
    }, {
        'type': 'Feature',
        'properties': {
            'name': 'alcohol',
            'featureclass': 'base'
        },
        'geometry': {
            'type': 'Point',
            'coordinates': [0.1, 52]
        },
        'id': 164
    }]
};

map.on('load', function () {
    map.addSource('places', {
        'type': 'geojson',
        'data': sourceData
    });

    map.addLayer({
        'id': 'top_labels',
        'type': 'symbol',
        'source': 'places',
        'filter': ['!=', ['get', 'featureclass'], 'top'],
        'layout': {
            'text-variable-anchor': ['top', 'bottom', 'left', 'right'],
            'text-field': ['get', 'name'],
            'text-offset': [1.2, 1.4],
            'text-size': 12
        },
        'paint': {
            'text-halo-color': '#fff',
            'text-halo-width': 2
        }
    });

    map.addLayer({
        'id': 'base_labels',
        'type': 'symbol',
        'source': 'places',
        'filter': ['!=', ['get', 'featureclass'], 'base'],
        'layout': {
            'text-variable-anchor': ['top', 'bottom', 'left', 'right'],
            'text-field': ['get', 'name'],
            'text-offset': [1.2, 1.4],
            'text-size': 12
        },
        'paint': {
            'text-halo-color': '#fff',
            'text-halo-width': 2
        }
    });

    map.addLayer({
        'id': 'top_icons',
        'type': 'symbol',
        'source': 'places',
        'filter': ['!=', ['get', 'featureclass'], 'base'],
        'layout': {
            'icon-overlap': 'cooperative',
            'icon-image': 'sprite2:airport',
            'icon-padding': 0
        }
    });

    map.addLayer({
        'id': 'base_icons',
        'type': 'symbol',
        'source': 'places',
        'filter': ['==', ['get', 'featureclass'], 'base'],
        'layout': {
            'icon-overlap': 'cooperative',
            'icon-image': 'alcohol', // no prefix because from the default sprite
            'icon-padding': 0
        }
    });

    map.showCollisionBoxes = true;

    map.addSprite('default', 'http://localhost:9966/test/debug-pages/sprite1');
    map.addSprite('sprite2', 'http://localhost:9966/test/debug-pages/sprite2');

    // 'sprite': 'http://localhost:9966/test/debug-pages/sprite1',
    //
    // 'sprite': [`
    //     {id: 'default', url: 'http://localhost:9966/test/debug-pages/sprite1'},
    //     {id: 'sprite2', url: 'http://localhost:9966/test/debug-pages/sprite2'}
    // ],
});

</script>
</body>
</html>
