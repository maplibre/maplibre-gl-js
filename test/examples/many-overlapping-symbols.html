<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Many overlapping symbols</title>
        <meta property="og:description" content="Many overlapping symbols." />
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="../../dist/maplibre-gl.css" />
        <script src="../../dist/maplibre-gl-dev.js"></script>
        <style>
            body {
                margin: 0;
                padding: 0;
            }

            html,
            body,
            #map {
                height: 100%;
            }
        </style>
    </head>

    <body>
        <div id="map"></div>
        <script>
            const map = new maplibregl.Map({
                container: "map",
                style: "https://tiles.openfreemap.org/styles/liberty",
                center: [-74.5, 40],
                zoom: 2,
            });

            function generateRandomPoints(count, bounds) {
                const features = [];

                for (let i = 0; i < count; i++) {
                    const lng =
                        bounds.west +
                        Math.random() * (bounds.east - bounds.west);
                    const lat =
                        bounds.south +
                        Math.random() * (bounds.north - bounds.south);

                    features.push({
                        type: "Feature",
                        geometry: {
                            type: "Point",
                            coordinates: [lng, lat],
                        },
                        properties: {
                            image: Math.random() > 0.5 ? "marker" : "airport",
                        },
                    });
                }

                return {
                    type: "FeatureCollection",
                    features: features,
                };
            }

            map.on("load", async () => {
                const pointData = generateRandomPoints(10000, {
                    west: -75.5,
                    east: -73.5,
                    south: 39.5,
                    north: 41.5,
                });

                map.addSource("random-points", {
                    type: "geojson",
                    data: pointData,
                });

                map.addLayer({
                    id: "symbols",
                    type: "symbol",
                    source: "random-points",
                    layout: {
                        "icon-image": ["get", "image"],
                        "icon-allow-overlap": true,
                    },
                });
            });
        </script>
    </body>
</html>
