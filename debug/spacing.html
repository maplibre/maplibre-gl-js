<!DOCTYPE html>
<html lang="en">
<head>
    <title>MapLibre GL JS debug page</title>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='stylesheet' href='../dist/maplibre-gl.css' />
    <style>
        body { margin: 0; padding: 0; }
        html, body, #map { height: 100%; }
    </style>
</head>

<body>
<div id='map'></div>

<script src='../dist/maplibre-gl-dev.js'></script>
<script>

var c = document.createElement('canvas');
c.width = 24;
c.height = 24;

var ctx = c.getContext('2d');
ctx.fillStyle = '#a00';
ctx.strokeStyle = '#fff';
ctx.lineWidth = 2;
ctx.ellipse(12, 12, 11, 11, 0, 0, 2 * Math.PI);
ctx.fill();
ctx.stroke();

var redCirc = ctx.getImageData(0, 0, 24, 24);

var map = new maplibregl.Map({
    container: 'map',
    center: [-73.9900, 40.7707],
    zoom: 16,
    hash: true,
    style: {
        'version': 8,
        'glyphs': 'https://demotiles.maplibre.org/font/{fontstack}/{range}.pbf',
        'sources': {
            'line': {
                'type': 'geojson',
                'data': {
                    'type': 'FeatureCollection',
                    'features': [
                        {
                            'type': 'Feature',
                            'geometry': {
                                'type': 'LineString',
                                'coordinates': [
                                    [-73.99203624883202, 40.7716680962221],
                                    [-73.98919824071197, 40.771287692508366],
                                    [-73.9865611535204, 40.77083120517665]
                                ]
                            }
                        },
                        // {
                        //     'type': 'Feature',
                        //     'geometry': {
                        //         'type': 'LineString',
                        //         'coordinates': [
                        //             [-73.99203624883202,40.7717680962221],
                        //             [-73.98919824071197,40.771387692508366],
                        //             [-73.9865611535204,40.77093120517665]
                        //         ]
                        //     }
                        // },
                    ]
                }
            },
            'point': {
                'type': 'geojson',
                'data': {
                    'type': 'Feature',
                    'geometry': {
                        'type': 'Point',
                        'coordinates': [-73.99118233488399, 40.771553975336815]
                    }
                }
            }
        },
        'layers': [
            {
                'id': 'background',
                'type': 'background',
                'paint': {
                    'background-color': '#444'
                }
            },
            {
                'id': 'line',
                'type': 'line',
                'source': 'line',
                'paint': {
                    'line-color': '#aaa',
                    'line-width': 3
                }
            },
            {
                'id': 'linelabel',
                'type': 'symbol',
                'source': 'line',
                'layout': {
                    // 'icon-image': 'redCirc',
                    // 'icon-text-fit': 'both',
                    'symbol-placement': 'line',
                    'text-field': 'X',
                    'text-font': ['Open Sans Semibold'],
                    'text-rotation-alignment': 'viewport'
                },
                'paint': {
                    'text-color': '#fff'
                }
            },
            {
                'id': 'point',
                'type': 'symbol',
                'source': 'point',
                'layout': {
                    'text-field': '*',
                    'text-font': ['Open Sans Semibold'],
                    'text-size': 32
                },
                'paint': {
                    'text-color': '#ff0',
                }
            }
        ]
    }
});

map.on('load', function () {
    map.addImage('redCirc', redCirc, {
        content: [6, 2, 18, 22]
    });
    map.collisionSymbolSpacing = true;
    map.showCollisionBoxes = true;
    map.showTileBoundaries = true;
});

</script>
</body>
</html>
